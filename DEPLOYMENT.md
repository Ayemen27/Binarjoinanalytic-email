# ุฏููู ุงููุดุฑ ุงูุชููุงุฆู - Laravel VPS Deployment Guide

## ๐ฏ ุงููุฏู
ูุฐุง ุงูุฏููู ูุณุงุนุฏู ุนูู ุฅุนุฏุงุฏ ูุธุงู ูุดุฑ ุชููุงุฆู ูุญู ูุดููุฉ ุงูุตูุงุญูุงุช ูุงูู cache ุจุดูู ุฏุงุฆู ุจุนุฏ ูู `git pull`.

---

## ๐ ุงูุฅุนุฏุงุฏ ุงูุฃููู (ูุฑุฉ ูุงุญุฏุฉ ููุท)

### 1. ุชูุนูู Git Hook ุงูุชููุงุฆู

ุจุนุฏ ุณุญุจ ุงููุดุฑูุน ุนูู ุงูู VPSุ ููุฐ ุงูุฃูุงูุฑ ุงูุชุงููุฉ:

```bash
# ุงูุงูุชูุงู ููุฌูุฏ ุงููุดุฑูุน
cd /home/administrator/panel

# ูุณุฎ ุงูู hook ุฅูู ูุฌูุฏ git
cp hooks/post-merge .git/hooks/post-merge

# ุฌุนู ุงูู hook ูุงุจู ููุชูููุฐ
chmod +x .git/hooks/post-merge

# ุฌุนู deploy.sh ูุงุจู ููุชูููุฐ
chmod +x deploy.sh
```

### 2. ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช ูู deploy.sh (ุฅุฐุง ูุฒู ุงูุฃูุฑ)

ุงูุชุญ ููู `deploy.sh` ูุชุญูู ูู ุงููุชุบูุฑุงุช ุงูุชุงููุฉ:

```bash
PHP_USER="www-data"        # ูุณุชุฎุฏู PHP-FPM (ูุฏ ูููู nginx ุฃู apache)
PHP_GROUP="www-data"       # ูุฌููุนุฉ PHP-FPM
```

**ููุนุฑูุฉ ุงููุณุชุฎุฏู ุงูุตุญูุญ ุนูู VPS:**
```bash
# ุชุญูู ูู ูุณุชุฎุฏู PHP-FPM
ps aux | grep php-fpm | grep -v grep

# ุฃู
cat /etc/php/8.2/fpm/pool.d/www.conf | grep "^user"
```

---

## ๐ฆ ููู ูุนูู ุงููุธุงู ุงูุชููุงุฆู

### ุนูุฏ ุชูููุฐ `git pull`:

1. โ ูุชู ุณุญุจ ุขุฎุฑ ุงูุชุญุฏูุซุงุช
2. โ ูุชู ุชุดุบูู `.git/hooks/post-merge` ุชููุงุฆูุงู
3. โ ูุชู ุชุดุบูู `deploy.sh` ุงูุฐู ูููู ุจู:
   - ุชุซุจูุช/ุชุญุฏูุซ Composer dependencies
   - ุถุจุท ุตูุงุญูุงุช ุงููููุงุช ุชููุงุฆูุงู
   - ูุณุญ ุฌููุน ุงูู caches
   - ุฅุนุงุฏุฉ ุชุญููู PHP-FPM
   - ุงูุชุญูู ูู ุชุญููู ุงูู classes

---

## ๐ง ุงูุงุณุชุฎุฏุงู ุงููููู

### ุงูุทุฑููุฉ ุงูุฃููู (ุชููุงุฆูุฉ - ููุตู ุจูุง):
```bash
git pull
# ูู ุดูุก ูุชู ุชููุงุฆูุงู ุจูุถู ุงูู hook!
```

### ุงูุทุฑููุฉ ุงูุซุงููุฉ (ูุฏููุฉ):
```bash
sudo bash deploy.sh
```

---

## ๐๏ธ ุฅุตูุงุญ ุงููุดููุฉ ุงูุญุงููุฉ (ูุฑุฉ ูุงุญุฏุฉ)

ุฅุฐุง ูุงูุช ุงููุดููุฉ ููุฌูุฏุฉ ุญุงููุงูุ ููุฐ ูุฐู ุงูุฃูุงูุฑ:

```bash
# ุงูุงูุชูุงู ููุฌูุฏ ุงููุดุฑูุน
cd /home/administrator/panel

# ุชุดุบูู ุณูุฑุจุช ุงููุดุฑ
sudo bash deploy.sh
```

---

## ๐ ุงูุตูุงุญูุงุช ุงูุตุญูุญุฉ ูู Laravel

### ุงููุฌูุฏุงุช ูุงููููุงุช:
- **ุงููุฌูุฏุงุช**: `755` (drwxr-xr-x)
- **ุงููููุงุช**: `644` (-rw-r--r--)
- **storage/**: `775` (drwxrwxr-x) - ูุงุจู ูููุชุงุจุฉ
- **bootstrap/cache/**: `775` (drwxrwxr-x) - ูุงุจู ูููุชุงุจุฉ

### ุงููุงูู:
- **ุงููุงูู ูุงููุฌููุนุฉ**: `www-data:www-data` (ุฃู ุญุณุจ ุฅุนุฏุงุฏ PHP-FPM)

---

## ๐ ุงูุชุญูู ูู ุญู ุงููุดููุฉ

### 1. ุงูุชุญูู ูู ุชุญููู ุงูู Class:
```bash
sudo -u www-data php -r "require 'vendor/autoload.php'; var_dump(class_exists('Lobage\\Planify\\Models\\Plan'));"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```
bool(true)
```

### 2. ูุฑุงูุจุฉ ุงูููุฌุงุช:
```bash
tail -f storage/logs/laravel.log
```

### 3. ุงุฎุชุจุงุฑ ุงูุชุทุจูู:
ุงูุชุญ ุงููุชุตูุญ ูุฌุฑุจ ุงููููุน

---

## โ๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูู Hook ูุง ูุนูู ุชููุงุฆูุงู

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ุฃู ุงูู hook ูุงุจู ููุชูููุฐ
chmod +x .git/hooks/post-merge

# ุชุฃูุฏ ูู ุฃู deploy.sh ูุงุจู ููุชูููุฐ
chmod +x deploy.sh
```

### ุงููุดููุฉ: Permission denied

**ุงูุญู:**
```bash
# ุชุดุบูู ุงูุณูุฑุจุช ุจุตูุงุญูุงุช root
sudo bash deploy.sh
```

### ุงููุดููุฉ: Class not found ุจุนุฏ Deploy

**ุงูุญู:**
```bash
# ูุณุญ OPcache ูุฏููุงู
sudo systemctl reload php8.2-fpm

# ุฅุนุงุฏุฉ ุชุญููู Composer autoload
composer dump-autoload -o

# ูุณุญ Laravel cache
php artisan optimize:clear
```

---

## ๐จ ุฃูุงูุฑ ูููุฏุฉ ุฅุถุงููุฉ

### ูุณุญ ุฌููุน ุงูู Caches:
```bash
php artisan optimize:clear
```

### ุฅุนุงุฏุฉ ุจูุงุก ุงูู Caches:
```bash
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

### ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช PHP-FPM:
```bash
# ูุนุฑูุฉ ุฅุตุฏุงุฑ PHP
php -v

# ูุนุฑูุฉ ูุณุชุฎุฏู PHP-FPM
ps aux | grep php-fpm | grep -v grep
```

### ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููููุงุช:
```bash
# ุงูุชุญูู ูู ุตูุงุญูุงุช storage
ls -la storage/

# ุงูุชุญูู ูู ุตูุงุญูุงุช vendor
ls -la vendor/lobage/
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ูุง ุชุนุฏู ุงููููุงุช ูู `vendor/` ูุฏููุงู** - ุงุณุชุฎุฏู Composer ุฏุงุฆูุงู
2. **ุงูุณูุฑุจุช ุขูู ููุชุดุบูู ุงููุชูุฑุฑ** - ููููู ุชุดุบููู ูู ุฃู ููุช
3. **Git Hook ูุนูู ุชููุงุฆูุงู** ุจุนุฏ `git pull` ุฃู `git merge`
4. **ูุง ุญุงุฌุฉ ูุชุนุฏูู ุงูุตูุงุญูุงุช ูุฏููุงู** ุจุนุฏ ุงูุขู
5. **ุงูุณูุฑุจุช ูุฏุนู ุงูุชุดุบูู ูู root ุฃู ูุณุชุฎุฏู ุนุงุฏู**

---

## ๐ ุงูุฃูุงู

- ุงูุณูุฑุจุช ูุณุชุฎุฏู `www-data` ููุณุชุฎุฏู ุงูุชุฑุงุถู
- ูุชู ุถุจุท ุงูุตูุงุญูุงุช ูููุงู ูุฃูุถู ุงูููุงุฑุณุงุช
- ูุง ูุชู ูุดู ูุนูููุงุช ุญุณุงุณุฉ
- OPcache ูุชู ูุณุญู ุชููุงุฆูุงู

---

## ๐ก ูุตุงุฆุญ ููุฅูุชุงุฌ (Production)

1. **ุงุณุชุฎุฏู Environment Variables** ููุฅุนุฏุงุฏุงุช ุงูุญุณุงุณุฉ
2. **ูุนูู OPcache** ูู ุงูุฅูุชุงุฌ ูุชุญุณูู ุงูุฃุฏุงุก
3. **ุงุณุชุฎุฏู Queue Workers** ููููุงู ุงูุซูููุฉ
4. **ุฑุงูุจ ุงูููุฌุงุช** ุจุงูุชุธุงู
5. **ุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ** ูุจู ุฃู ุชุญุฏูุซ ูุจูุฑ

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุงูููุฌุงุช: `tail -f storage/logs/laravel.log`
2. ุชุญูู ูู ุตูุงุญูุงุช ุงููููุงุช
3. ุชุฃูุฏ ูู ุชุดุบูู PHP-FPM ุจุดูู ุตุญูุญ
4. ุฌุฑุจ ุชุดุบูู `deploy.sh` ูุฏููุงู

---

## โ Checklist ุงููุดุฑ

- [ ] ูุณุฎ post-merge hook ุฅูู `.git/hooks/`
- [ ] ุฌุนู ุงูู hooks ู deploy.sh ูุงุจูุฉ ููุชูููุฐ
- [ ] ุชุนุฏูู PHP_USER ู PHP_GROUP ุฅุฐุง ูุฒู ุงูุฃูุฑ
- [ ] ุชุดุบูู `deploy.sh` ุฃูู ูุฑุฉ
- [ ] ุงูุชุญูู ูู ุนูู ุงูุชุทุจูู
- [ ] ุงุฎุชุจุงุฑ `git pull` ูุงูุชุฃูุฏ ูู ุชุดุบูู ุงูู hook ุชููุงุฆูุงู

---

**ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ:** Replit Agent  
**ุงูุชุงุฑูุฎ:** 2025-10-28  
**ุงูุฅุตุฏุงุฑ:** 1.0
